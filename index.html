<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>お弁当アンケート AR体験</title>
<style>
  /* 全体背景 */
  body {
    margin: 0;
    background-image: url('https://raw.githubusercontent.com/minami00901/bento-ar/main/%E3%83%86%E3%82%B9%E3%83%88.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    font-family: sans-serif;
    overflow-x: hidden;
    color: #333;
  }

  /* 質問部分のスタイル */
  .question-box {
    background-color: rgba(135, 206, 250, 0.8); /* 水色半透明 */
    border-radius: 1rem;
    padding: 2rem;
    margin: 2rem auto;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    text-align: center;
  }

  /* 選択肢ボタン */
  .options button {
    margin: 1rem;
    padding: 1rem 2rem;
    font-size: 1rem;
    border-radius: 1rem;
    background: #ffd700;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  .options button:hover {
    background-color: #ffec5c;
  }

  /* ありがとう画面のコンテナ */
  #thanksImage {
    position: relative;
    width: 100vw;
    height: 80vh;
    margin: 0 auto;
    overflow: visible;
    display: none;
  }

  /* ありがとう画像 */
  #thanksImg {
    position: absolute;
    width: 200px;
    height: 200px;
    object-fit: contain;
    cursor: default;
    user-select: none;
    will-change: transform;
  }

  /* 「ありがとう」テキスト */
  #thanksText {
    position: absolute;
    width: 100%;
    top: 75%;
    left: 0;
    text-align: center;
    font-size: 2rem;
    font-weight: bold;
    color: #ff4500;
    text-shadow:
       0 0 5px #ff4500,
       0 0 10px #ffa07a,
       0 0 20px #ffa07a,
       0 0 40px #ff6347;
    pointer-events: none;
  }

  /* クラッカーエフェクト */
  .confetti-piece {
    position: absolute;
    width: 8px;
    height: 16px;
    background-color: #ffd700;
    opacity: 0.9;
    border-radius: 3px;
    animation: confetti-fall 1.5s forwards;
  }

  @keyframes confetti-fall {
    0% {
      opacity: 1;
      transform: translateY(0) rotate(0deg);
    }
    100% {
      opacity: 0;
      transform: translateY(100vh) rotate(360deg);
    }
  }
</style>
</head>
<body>

  <div class="question-box" id="questionBox">
    <h1>今日のお弁当はいかがでしたか？</h1>
    <button onclick="showRandomQuestion()">質問を表示</button>
  </div>

  <div class="question-box" id="questionArea" style="display:none;"></div>

  <div id="thanksImage">
    <img id="thanksImg" src="" alt="ありがとう画像" />
    <div id="thanksText">おいしいとデジタルでつながる！</div>
  </div>

<script>
  const questions = [
    {
      text: "今日のお弁当はいかがでしたか？",
      options: [
        "① とても美味しかった（心の中で拍手しました）",
        "② 普通（空腹は満たされました）",
        "③ ちょっと惜しい（あと一歩の伸びしろ）"
      ]
    },
    {
      text: "またこのお弁当を食べたいですか？",
      options: [
        "① ぜひもう一度食べたいです！",
        "② 内容によっては",
        "③ 今日はごちそうさまでした…"
      ]
    },
    {
      text: "このお弁当、どんな人に勧めたいですか？",
      options: [
        "① 午後イチ会議で眠そうなあの人",
        "② アイデアが枯渇している商品開発部員",
        "③ 自分（また食べたい）"
      ]
    }
  ];

  // ありがとう画像（1枚のみランダムではなく固定でもOK）
  const thanksImages = [
    "https://raw.githubusercontent.com/minami00901/bento-ar/main/%E3%81%8A%E3%81%84%E3%81%97%E3%81%84%E3%81%A8%E3%83%87%E3%82%B8%E3%82%BF%E3%83%AB%E3%81%A7%E7%B9%8B%E3%81%8C%E3%82%8C%EF%BC%81.png"
  ];

  // 質問ボックスの要素
  const questionBox = document.getElementById("questionBox");
  const questionArea = document.getElementById("questionArea");
  const thanksImageDiv = document.getElementById("thanksImage");
  const thanksImg = document.getElementById("thanksImg");
  const thanksText = document.getElementById("thanksText");

  // 質問をランダム表示
  function showRandomQuestion() {
    const q = questions[Math.floor(Math.random() * questions.length)];
    questionBox.style.display = "none";
    questionArea.style.display = "block";
    questionArea.innerHTML = `<h2>${q.text}</h2><div class="options">${q.options.map((opt, i) =>
      `<button onclick="showThanks()">${opt}</button>`).join("")}</div>`;
  }

  // ありがとう画面表示
  function showThanks() {
    questionArea.style.display = "none";
    thanksImageDiv.style.display = "block";

    // 画像セット（今回は1枚のみなので固定）
    thanksImg.src = thanksImages[0];

    // 初期位置：画面のランダム位置
    const startX = Math.random() * (window.innerWidth - 200);
    const startY = Math.random() * (window.innerHeight - 200);

    // 最終位置（中央）
    const centerX = (window.innerWidth - 200) / 2;
    const centerY = (window.innerHeight - 200) / 2;

    // 画像を初期位置にセット
    thanksImg.style.transform = `translate(${startX}px, ${startY}px)`;

    // キラキラテキストは非表示から表示
    thanksText.style.opacity = 0;

    // クラッカーエフェクト用のパーティクル生成
    createConfetti();

    // 2秒かけて真ん中に移動
    let startTime = null;
    function animate(time) {
      if (!startTime) startTime = time;
      const elapsed = time - startTime;
      const duration = 2000; // 2秒

      if (elapsed < duration) {
        // 線形補間で位置を計算
        const progress = elapsed / duration;
        const currentX = startX + (centerX - startX) * progress;
        const currentY = startY + (centerY - startY) * progress;
        thanksImg.style.transform = `translate(${currentX}px, ${currentY}px)`;
        requestAnimationFrame(animate);
      } else {
        // 完了→中央に固定し、キラキラテキストをフェードイン
        thanksImg.style.transform = `translate(${centerX}px, ${centerY}px)`;
        fadeInThanksText();
      }
    }
    requestAnimationFrame(animate);
  }

  // キラキラテキストをフェードイン
  function fadeInThanksText() {
    let opacity = 0;
    thanksText.style.opacity = 0;
    thanksText.style.transition = "opacity 2s ease-in-out";
    setTimeout(() => {
      thanksText.style.opacity = 1;
    }, 100); 
  }

  // クラッカー（コンフェッティ）を画面に降らせる
  function createConfetti() {
    const confettiCount = 30;

    for(let i = 0; i < confettiCount; i++) {
      const confetti = document.createElement('div');
      confetti.classList.add('confetti-piece');
      confetti.style.left = Math.random() * window.innerWidth + 'px';
      confetti.style.top = (-20 - Math.random() * 100) + 'px';
      confetti.style.backgroundColor = randomColor();
      confetti.style.animationDelay = (Math.random() * 1.5) + 's';
      confetti.style.transform = `rotate(${Math.random()*360}deg)`;

      document.body.appendChild(confetti);

      // アニメーション終了後に要素を削除
      confetti.addEventListener('animationend', () => {
        confetti.remove();
      });
    }
  }

  // ランダムなクラッカー色（キラキラカラー）
  function randomColor() {
    const colors = ['#ffd700', '#ffa500', '#ff4500', '#ffff00', '#ff69b4', '#00ffff'];
    return colors[Math.floor(Math.random() * colors.length)];
  }
</script>

</body>
</html>
